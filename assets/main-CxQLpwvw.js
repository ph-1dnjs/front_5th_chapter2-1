import"./modulepreload-polyfill-B5Qt9EMX.js";const i=[{id:"p1",name:"상품1",price:1e4,stock:50},{id:"p2",name:"상품2",price:2e4,stock:30},{id:"p3",name:"상품3",price:3e4,stock:20},{id:"p4",name:"상품4",price:15e3,stock:0},{id:"p5",name:"상품5",price:25e3,stock:10}],y={p1:.1,p2:.15,p3:.2,p4:.05,p5:.25},E=.8,h=30,d=.25,T=2,m=.1,x=3e4,g=6e4,k=5,s="x ",C="재고가 부족합니다.",v=()=>{const t=document.createElement("div");return t.className="bg-gray-100 p-8",t},S=()=>{const t=document.createElement("div");return t.className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8",t.appendChild($()),t.appendChild(b()),t.appendChild(_()),t.appendChild(L()),t.appendChild(w()),t.appendChild(D()),t},b=()=>{const t=document.createElement("div");return t.id="cart-items",t},D=()=>{const t=document.createElement("div");return t.id="stock-status",t.className="text-sm text-gray-500 mt-2",t},$=()=>{const t=document.createElement("h1");return t.className="text-2xl font-bold mb-4",t.textContent="장바구니",t},_=()=>{const t=document.createElement("div");return t.id="cart-total",t.className="text-xl font-bold my-4",t},N=t=>{const e=document.createElement("div");return e.id=t.id,e.className="flex justify-between items-center mb-2",e.innerHTML=`
    <span>${t.name} - ${t.price}원 x 1</span>
    <div>
			<button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="-1">-</button>
			<button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="1">+</button>
			<button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${t.id}">삭제</button>
    </div>
    `,e},w=()=>{const t=document.createElement("button");return t.id="add-to-cart",t.className="bg-blue-500 text-white px-4 py-2 rounded",t.textContent="추가",t},L=()=>{const t=document.createElement("select");return t.id="product-select",t.className="border rounded p-2 mr-2",t},M=t=>{const e=document.createElement("span");return e.className="text-green-500 ml-2",e.textContent=`(${(t*100).toFixed(1)}% 할인 적용)`,e},R=()=>{const t=document.createElement("span");return t.id="loyalty-points",t.className="text-blue-500 ml-2",t};function B(t,e,n){let o=e,c=0;const a=t-e;return n>=h&&t*d>a?(o=t*(1-d),c=d):c=a/t,new Date().getDay()===T&&(o*=1-m,c=Math.max(c,m)),{finalTotal:o,appliedDiscountRate:c}}function A(t,e){return e<10?0:y[t]||0}function U(t){let e=0,n=0,o=0;return t.forEach(c=>{const a=i.find(I=>I.id===c.id),r=O(c),l=a.price*r,f=A(a.id,r);e+=l,n+=l*(1-f),o+=r}),{totalBeforeDiscount:e,totalAfterItemDiscount:n,productCount:o}}function q(t,e,n){const o=parseInt(e.dataset.change),c=parseInt(t.querySelector("span").textContent.split(s)[1]),a=c+o,r=n.stock+c;if(a<=0){t.remove(),n.stock-=o;return}if(a>r){alert(C);return}t.querySelector("span").textContent=`${t.querySelector("span").textContent.split(s)[0]}${s}${a}`,n.stock-=o}function O(t){return parseInt(t.querySelector("span").textContent.split(s)[1])}function P(t,e){const n=parseInt(t.querySelector("span").textContent.split(s)[1]);e.stock+=n,t.remove()}function p(){document.getElementById("product-select").innerHTML="",i.forEach(function(t){const e=document.createElement("option");e.value=t.id,e.textContent=`${t.name} - ${t.price}원`,t.stock===0&&(e.disabled=!0),document.getElementById("product-select").appendChild(e)})}function Q(){let t="";const e=document.getElementById("stock-status");i.forEach(function(n){n.stock<k&&(t+=`${n.name}: ${n.stock>0?`재고 부족 (${n.stock}개 남음)`:"품절"}
`)}),e.textContent=t}const H=(t,e)=>{const n=Math.floor(e/1e3);let o=document.getElementById("loyalty-points");o||(o=R(),t.appendChild(o)),o.textContent=`(포인트: ${n})`};function u(){const t=[...document.getElementById("cart-items").children],{totalBeforeDiscount:e,totalAfterItemDiscount:n,productCount:o}=U(t),{finalTotal:c,appliedDiscountRate:a}=B(e,n,o);K(c,a),Q(),H(document.getElementById("cart-total"),c)}function K(t,e){const n=document.getElementById("cart-total");n.textContent=`총액: ${Math.round(t)}원`,e>0&&n.appendChild(M(e))}function Y(t,e){const n=t.querySelector("span"),c=X(n.textContent)+1;if(c>e.stock){alert(C);return}n.textContent=`${e.name} - ${e.price}원 ${s}${c}`,e.stock--}function X(t){return parseInt(t.split(s)[1])}function G(t){const e=N(t);document.getElementById("cart-items").appendChild(e),t.stock--}function V(t){return i.find(e=>e.id===t)}function W(){document.getElementById("add-to-cart").addEventListener("click",j),document.getElementById("cart-items").addEventListener("click",F)}function j(){const e=document.getElementById("product-select").value,n=V(e);if(!n||n.stock<=0)return;const o=document.getElementById(n.id);o?Y(o,n):G(n),u()}function F(t){const e=t.target,n=e.dataset.productId,o=document.getElementById(n),c=i.find(function(a){return a.id===n});e.classList.contains("quantity-change")?q(o,e,c):e.classList.contains("remove-item")&&P(o,c),u()}function z(){const t=document.getElementById("app"),e=v(),n=S();e.appendChild(n),t.appendChild(e),p(),u(),W(),setTimeout(function(){setInterval(function(){const o=i[Math.floor(Math.random()*i.length)];Math.random()<.3&&o.stock>0&&(o.price=Math.round(o.price*E),alert(`번개세일! ${o.name}이(가) 20% 할인 중입니다!`),p())},x)},Math.random()*1e4),setTimeout(function(){setInterval(function(){},g)},Math.random()*2e4)}z();
